; Программа для преобразования строки по заданному правилу
; S3 <-> S9, S2 <- S4 - (S5 - S6)

.model small
.stack 100h
.data
  msg db "Введите строку: $"
  str db 20 dup(0) ; буфер для строки
  len db ? ; длина строки
  res db "Результат: $"
.code
  mov ax, @data ; установить сегмент данных
  mov ds, ax

  ; вывод сообщения
  mov ah, 09h ; функция DOS для вывода строки
  mov dx, offset msg ; адрес строки в dx
  int 21h ; вызов DOS

  ; ввод строки
  mov ah, 0Ah ; функция DOS для ввода строки
  mov dx, offset str ; адрес буфера в dx
  int 21h ; вызов DOS

  ; получение длины строки
  mov al, str[1] ; длина строки во втором байте буфера
  mov len, al

  ; проверка длины строки на достаточность
  cmp al, 9 ; нужно хотя бы 9 символов
  jae transform ; если достаточно, то переходим к преобразованию
  jmp end ; иначе завершаем программу

transform:
  ; обмен местами S3 и S9
  mov al, str[2+3] ; al = S3
  xchg al, str[2+9] ; al = S9, str[2+9] = S3
  mov str[2+3], al ; str[2+3] = S9

  ; вычисление S4 - (S5 - S6)
  mov al, str[2+4] ; al = S4
  sub al, str[2+5] ; al = al - S5 = S4 - S5
  add al, str[2+6] ; al = al + S6 = S4 - (S5 - S6)

  ; запись результата в S2
  mov str[2+2], al

  ; вывод результата
  mov ah, 09h ; функция DOS для вывода строки
  mov dx, offset res ; адрес строки в dx
  int 21h ; вызов DOS

end:
; ожидание нажатия клавиши
mov ah,00h 
int16h 

; завершение программы 
mov ax,4c00h 
int21h 

end 